---
title: 数据库系统原理：第二章关系数据库（一）
date: 2020-03-07 13:21:09
tags: [数据库系统原理, 笔记]
categories: [数据库系统原理]
index_img: /img/数据库系统/header.png
math: true
---

数据库系统原理：第二章关系数据库中的关系模型的相关内容。

<!-- more -->

# 关系模型

## 一、关系数据结构

<h3 id="Relationship"> 1.1概念 </h3>

#### 1.域及笛卡尔积
![](/img/数据库系统/关系数据结构.png)

<a href="https://durancex.github.io/2020/02/28/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%EF%BC%9A%E7%AC%AC%E4%B8%80%E7%AB%A0%E7%BB%AA%E8%AE%BA/#relation_module" target="_self">对应关系</a>

 - 属性为单列，例如学号
 - 值即为单个属性值，例如201501001
 - 关系型：模式即为图中第一行，是所有属性的集合
 - 关系实例为图中第二行，是一条具体记录
 - 域为取值范围，例如性别的域为{‘男’，‘女’}

了解了域的概念之后，可以在多个域的基础上计算笛卡尔积，给定一组域$D_1, D_2, D_3.....D_n$，允许其中某些域是相同的，那么$D_1, D_2, D_3.....D_n$的笛卡尔积为
$$D_1×D_2×D_3×.....×D_n=\{(d_1,d_2,....,d_n)|d_i∈D_i,i=1,2,....,n\}$$ 
也就是$D_1, D_2, D_3.....D_n$中所有可能的组合，笛卡尔积可以看做是关系的“域”

其中，$D_1, D_2, D_3.....D_n$各自的域的大小之积称为**基数**
例如，给出3个域：
$D_1$=导师集合SUPERVISOR={张一，张二}
$D_2$=专业集合SUPERVISOR={计算机，软件}
$D_3$=研究生集合POSTGRADUATE={李三，李四，李五}
那么$D_1×D_2×D_3$=
{(张一，计算机，李三)，(张一，计算机，李四)，(张一，计算机，李五)
(张一，软件，李三)， (张一，软件，李四)， (张一，软件，李五)
......}
基数为$2*2*3=12$，表示成二维表即：
SUPERVISOR |SUPERVISOR| POSTGRADUATE
:-:|:-:|:-:|
张一|计算机|李三
张一|计算机|李四
张一|计算机|李五
张一|软件|李三
张一|软件|李四
张一|软件|李五
张二|计算机|李三
......||

#### 2.关系
$D_1×D_2×D_3×....×D_n$的子集叫作在域$D_1, D_2, D_3.....D_n$上的关系，表示为
$$R(D_1,D_2,....,D_n)$$ 
$R$：关系名
$n$：关系的目或度

#### 3.元组
关系中的每个元素($d_1,d_2,....,d_n$)叫作一个$n$元组，简称元组，通常用$t$表示。

#### 4.属性
同Excel表，即列，每列都得有列名，称为属性，n目关系必有n个属性

#### ⭐5.码

- 候选码
  若关系中的某一属性组的值能唯一标识一个元组，则称该属性组为候选码
  简单的情况：候选码只包含一个属性。
- 全码
  最极端的情况中，关系模式的所有属性组是这个关系模式的候选码，成为全码

**注意点**

- 任何关系必有码
- 任何关系必有主码，且**主码唯一**
- 任何关系必有候选码，但候选码可以不唯一
- 当关系只有一个候选码时，该关系的码就是其候选码也就是主码
- 主码时候选码的子集，即主码一定包含在候选码中，由开发者在候选码中任选其一。
  
例如：
学号|姓名|性别|专业|身份证号
:-:|:-:|:-:|:-:|:-:|
201501001|张三|男|软件工程|6666666666666|

在该示例中，候选码为{学号，身份证号}，因为学号和身份证号都能唯一确定学生身份，主码则为两者二选其一，比如学号。

#### 6.关系类型
关系可以有三种类型
- 基本表
- 查询表（基本表进行数据筛选后的表）
- 视图表

当n=1时，称该关系为单元关系和一元关系
当n=2时，称该关系为二元关系

#### 7.基本关系的性质
1. 列是同质的，即一列中数据类型和意义相同
2. 不同的列可出自同一个域，即取值范围可以相同
3. 列的次序可以交换
4. 任意两个元组的候选码不能相同，因为候选码需要满足可以唯一确定一条记录的性质
5. 行的次序可以交换
6. 分量必须取原子值，即分量不可再分，出现表中表的情况

### 1.2 关系模式

#### 1.什么是关系模式
- 关系模式是型
- 关系是值
- 关系模式是对关系的描述
  - 元组集合的结构
    - 属性构成
    - 属性来自的域
    - 属性与域之间的关系
  - 完整性约束条件

#### 2.定义关系模式
关系模式可以形式化地表示为：
$$R(U,D,DOM,F)$$
$R$ &emsp;&emsp;关系名
$U$ &emsp;&emsp;组成关系的属性名集合
$D$ &emsp;&emsp;$U$中属性所来自的域
$DOM$ &emsp;&emsp;属性向域的映像集合
$F$ &emsp;&emsp;属性间数据的依赖关系的集合

⭐示例:
**STUDENT(U,D,DOM,F)**
**U{sno,name,age}   &emsp;&emsp;&emsp;&emsp;//理解为表的字段(属性)的集合
D{char,int} &emsp;&emsp;&emsp;&emsp;//理解为表中字段的类型集合
DOM{dom(sno)=dom(name)=char,dom(age)=int} &emsp;&emsp;&emsp;&emsp;//理解为每个字段具体的取值
F(sno-->name,sno-->age)&emsp;&emsp;&emsp;&emsp;//理解为表字段的关系**
<p class="note note-primary">
其中F的中元素的意思是，知道了学生的学号(sno)就可以知道学生的姓名(name)和年龄(age)，所以是sno-->name,sno-->age，但因为知道了年龄和姓名不能知道学号，所以不能有name-->sno，age-->sno
</p>

关系模式的表示：
5元组$R(U,D,DOM,F)$
3元组$R(U,F)$
2元组$R(U)$

#### 3.关系模式与关系的“关系”
- 关系模式
  - 对关系的描述
  - 静态的、稳定的
- 关系
  - 关系模式在某一时刻的状态和内容
  - 即关系模式的具体取值
- 关系模式和关系往往笼统称为关系

### 1.3 关系数据库
- 关系数据库
  - 在一个给定的应用领域中，所有关系的集合构成一个关系数据库
- 关系数据库的型和值
  - 关系数据库的型：关系数据库模式，是对关系数据库的描述，也就是关系模式
  - 关系数据库的值，关系模式在某一时刻对应的**关系的集合**，通常称为关系数据库

## 二、关系模型（关系完整性约束）

### 2.1 实体完整性
关系的主属性不能取空值

例如：
选修(<u>学号，课程号</u> ,成绩)
其中学号和课程号为候选码，因此两个值都不能取空值

### 2.2 参照完整性
#### 1. 关系间的引用
示例：
学生（<u>学号</u>，姓名，性别，<font color=blue>专业号</font>，年龄）
专业（<font color=blue>专业号</font>，专业名）
<p class="note note-primary">此时学生关系中引用了专业关系中的主码“专业号”，此时要求学生关系中的“专业号”必须是真实存在的专业号，即能在专业关系中找到该专业号</p>

#### 2.外码
设**F**是基本关系**R**的一个或一组属性，但不是关系**R**的码。
如果**F**与基本关系**S**的主码**K~S~**相对应，则称**F**和**R**的外码
基本关系**R**称为参照关系
基本关系**S**称为被参照关系

示例：
学生（<u>学号</u>，姓名，性别，<font color=blue>专业号</font>，年龄）
专业（<font color=blue>专业号</font>，专业名）
<p class="note note-primary">
“专业号”属性是学生关系的外码<br />
专业关系是被参照关系，学生关系为参照关系</p>

#### 3.参照完整性规则
若属性**F**是基本关系**R**的外码，它与基本关系**S**的主码**K~S~**相对应（基本关系**R**和**S**可以是同一个关系），则对于**R**中每个元组在**F**上的值必须为：
- 或者取空值
- 或者等于**S**中某个元组的主码值

示例：
学生关系的每个元组的“专业号”属性的取值：
（1）空值，表示还未给该学生分配专业
（2）非空值，这时该值必须为专业关系中存在的“专业号”值

### 2.3 用户定义的完整性
即关系模型应提供了自定义完整性规则的接口

示例：
课程(<u>课程号</u>,课程名，学分)
- 课程号为主码，必须取唯一值
- 非主属性“课程名”也不能取空值
- “学分”属性只能取值{1，2，3，4}

其中“学分”项的取值范围即为自行设定的完整性规则，规定其域。

